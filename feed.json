{
    "version": "https://jsonfeed.org/version/1",
    "title": "Mino",
    "subtitle": "",
    "icon": "https://www.minomie.com/images/favicon.ico",
    "description": "",
    "home_page_url": "https://www.minomie.com",
    "items": [
        {
            "id": "https://www.minomie.com/web/back-end/php/php%E4%BD%BF%E7%94%A8PhpSpreadsheet%E5%AF%B9Excel%E8%BF%9B%E8%A1%8C%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BAMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/",
            "url": "https://www.minomie.com/web/back-end/php/php%E4%BD%BF%E7%94%A8PhpSpreadsheet%E5%AF%B9Excel%E8%BF%9B%E8%A1%8C%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BAMySQL%E6%95%B0%E6%8D%AE%E5%BA%93/",
            "title": "php使用PhpSpreadsheet对Excel进行导入和导出MySQL数据库",
            "date_published": "2024-10-14T08:27:55.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>在早期的实习中，我所在的项目中需要将 Excel 文件导入到数据库中，并将数据库中的数据导出到 Excel 文件中。由于项目中使用的数据库为 MySQL，因此需要使用 PHP 对 Excel 文件进行导入和导出。</p>\n<h2 id=\"准备工作\"><a class=\"anchor\" href=\"#准备工作\">#</a> 准备工作</h2>\n<h3 id=\"初识phpspreadsheet\"><a class=\"anchor\" href=\"#初识phpspreadsheet\">#</a> 初识 PhpSpreadsheet</h3>\n<p>PhpSpreadsheet 是一个开源的 PHP 库，可以用来处理各种电子表格文件，包括 Excel、CSV、ODS 等。<br />\n官网：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9waHBzcHJlYWRzaGVldC5yZWFkdGhlZG9jcy5pby9lbi9zdGFibGUv\">https://phpspreadsheet.readthedocs.io/en/stable/</span></p>\n<h3 id=\"安装phpspreadsheet\"><a class=\"anchor\" href=\"#安装phpspreadsheet\">#</a> 安装 PhpSpreadsheet</h3>\n<p>使用 Composer 安装 PhpSpreadsheet：</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>composer require phpoffice&#x2F;phpspreadsheet</pre></td></tr></table></figure><h2 id=\"demo目录\"><a class=\"anchor\" href=\"#demo目录\">#</a> demo 目录</h2>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>├── vendor</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>│   ...</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>│   └── autoload.php</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>├── index.php</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>├── index2.php</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>├── db.php</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>└── excel.xlsx</pre></td></tr></table></figure><h2 id=\"使用\"><a class=\"anchor\" href=\"#使用\">#</a> 使用</h2>\n<h3 id=\"导入excel文件到mysql数据库\"><a class=\"anchor\" href=\"#导入excel文件到mysql数据库\">#</a> 导入 Excel 文件到 MySQL 数据库</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"><span>index.php</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">require</span> <span class=\"token string single-quoted-string\">'vendor/autoload.php'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"db.php\"</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// 连接数据库</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$reader</span> <span class=\"token operator\">=</span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>PhpOffice<span class=\"token punctuation\">\\</span>PhpSpreadsheet<span class=\"token punctuation\">\\</span>IOFactory</span><span class=\"token operator\">::</span><span class=\"token function\">createReader</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Xlsx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$reader</span><span class=\"token operator\">-></span><span class=\"token function\">setReadDataOnly</span><span class=\"token punctuation\">(</span><span class=\"token constant boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$spreadsheet</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$reader</span><span class=\"token operator\">-></span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'excel.xlsx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 载入 excel 表格</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token variable\">$worksheet</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$spreadsheet</span><span class=\"token operator\">-></span><span class=\"token function\">getActiveSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token variable\">$highestRow</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">getHighestRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 总行数</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token variable\">$highestColumn</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">getHighestColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 总列数</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token variable\">$highestColumnIndex</span> <span class=\"token operator\">=</span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>PhpOffice<span class=\"token punctuation\">\\</span>PhpSpreadsheet<span class=\"token punctuation\">\\</span>Cell<span class=\"token punctuation\">\\</span>Coordinate</span><span class=\"token operator\">::</span><span class=\"token function\">columnIndexFromString</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$highestColumn</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 总列数转为数字</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token variable\">$lines</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$highestRow</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lines</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Excel表格中没有数据'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"INSERT INTO `t_student` (`name`, `chinese`, `maths`, `english`) VALUES \"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$row</span> <span class=\"token operator\">&lt;=</span> <span class=\"token variable\">$highestRow</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span><span class=\"token variable\">$row</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">getCellByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 姓名</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token variable\">$chinese</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">getCellByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 语文</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token variable\">$maths</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">getCellByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 数学</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token variable\">$english</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">getCellByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 外语</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token variable\">$sql</span> <span class=\"token operator\">.=</span> <span class=\"token string double-quoted-string\">\"('<span class=\"token interpolation\"><span class=\"token variable\">$name</span></span>','<span class=\"token interpolation\"><span class=\"token variable\">$chinese</span></span>','<span class=\"token interpolation\"><span class=\"token variable\">$maths</span></span>','<span class=\"token interpolation\"><span class=\"token variable\">$english</span></span>'),\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token function\">rtrim</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 去掉最后一个，号</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token variable\">$db</span><span class=\"token operator\">-></span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> <span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$e</span><span class=\"token operator\">-></span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>worksheet-&gt;getCellByColumnAndRow (col, row)-&gt;getValue () 可以获取表格中任意单元格数据内容，col 表示单元格所在的列，以数字表示，A 列表示第一列，$row 表示所在的行。</p>\n<h3 id=\"导出mysql数据库到excel文件\"><a class=\"anchor\" href=\"#导出mysql数据库到excel文件\">#</a> 导出 MySQL 数据库到 Excel 文件</h3>\n<h4 id=\"一-设置表头\"><a class=\"anchor\" href=\"#一-设置表头\">#</a> 一、设置表头</h4>\n<p>首先我们引入自动加载 PhpSpreadsheet 库，然后实例化，设置工作表标题名称为：学生成绩表，接着设置表头内容。表头分为两行，第一行是表格的名称，第二行数表格列名称。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"><span>index2.php</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">require</span> <span class=\"token string single-quoted-string\">'vendor/autoload.php'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">use</span> <span class=\"token package\">PhpOffice<span class=\"token punctuation\">\\</span>PhpSpreadsheet<span class=\"token punctuation\">\\</span>Spreadsheet</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">use</span> <span class=\"token package\">PhpOffice<span class=\"token punctuation\">\\</span>PhpSpreadsheet<span class=\"token punctuation\">\\</span>Writer<span class=\"token punctuation\">\\</span>Xlsx</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'conn.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 连接数据库</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$spreadsheet</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Spreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token variable\">$worksheet</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$spreadsheet</span><span class=\"token operator\">-></span><span class=\"token function\">getActiveSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">// 设置工作表标题名称</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'学生成绩表'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">// 表头</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 设置单元格内容</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'学生成绩表'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'姓名'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'语文'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'数学'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'外语'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'总分'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">// 合并单元格</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">mergeCells</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'A1:E1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token variable\">$styleArray</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token string single-quoted-string\">'font'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token string single-quoted-string\">'bold'</span> <span class=\"token operator\">=></span> <span class=\"token constant boolean\">true</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token string single-quoted-string\">'alignment'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token string single-quoted-string\">'horizontal'</span> <span class=\"token operator\">=></span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>PhpOffice<span class=\"token punctuation\">\\</span>PhpSpreadsheet<span class=\"token punctuation\">\\</span>Style<span class=\"token punctuation\">\\</span>Alignment</span><span class=\"token operator\">::</span><span class=\"token constant\">HORIZONTAL_CENTER</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\">// 设置单元格样式</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">getStyle</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'A1'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">applyFromArray</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$styleArray</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">setSize</span><span class=\"token punctuation\">(</span><span class=\"token number\">28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">getStyle</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'A2:E2'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">applyFromArray</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$styleArray</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getFont</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">setSize</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"二-读取数据\"><a class=\"anchor\" href=\"#二-读取数据\">#</a> 二、读取数据</h4>\n<p>我们连接数据库后，直接读取学生成绩表 t_student，然后 for 循环，设置每个单元格对应的内容，计算总成绩。注意的是表格中的数据是从第 3 行开始，因为第 1，2 行是表头占用了。。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"><span>index2.php</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT id,name,chinese,maths,english FROM `t_student`\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$stmt</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$db</span><span class=\"token operator\">-></span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$rows</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$stmt</span><span class=\"token operator\">-></span><span class=\"token function\">fetch_assoc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$rows</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 按行添加到数组中</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$len</span> <span class=\"token operator\">=</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rows</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$j</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$len</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token variable\">$j</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 从表格第 3 行开始</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$j</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$rows</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$j</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$rows</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'chinese'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$j</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$rows</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'maths'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$j</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$rows</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'english'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">setCellValueByColumnAndRow</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$j</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$rows</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'chinese'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$rows</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'maths'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$rows</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'english'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$styleArrayBody</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token string single-quoted-string\">'borders'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token string single-quoted-string\">'allBorders'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token string single-quoted-string\">'borderStyle'</span> <span class=\"token operator\">=></span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>PhpOffice<span class=\"token punctuation\">\\</span>PhpSpreadsheet<span class=\"token punctuation\">\\</span>Style<span class=\"token punctuation\">\\</span>Border</span><span class=\"token operator\">::</span><span class=\"token constant\">BORDER_THIN</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token string single-quoted-string\">'color'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'argb'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'666666'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token string single-quoted-string\">'alignment'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token string single-quoted-string\">'horizontal'</span> <span class=\"token operator\">=></span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>PhpOffice<span class=\"token punctuation\">\\</span>PhpSpreadsheet<span class=\"token punctuation\">\\</span>Style<span class=\"token punctuation\">\\</span>Alignment</span><span class=\"token operator\">::</span><span class=\"token constant\">HORIZONTAL_CENTER</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token variable\">$total_rows</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$len</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\">// 添加所有边框 / 居中</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token variable\">$worksheet</span><span class=\"token operator\">-></span><span class=\"token function\">getStyle</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'A1:E'</span><span class=\"token operator\">.</span><span class=\"token variable\">$total_rows</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">applyFromArray</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$styleArrayBody</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"三-下载保存\"><a class=\"anchor\" href=\"#三-下载保存\">#</a> 三、下载保存</h4>\n<p>强制浏览器下载数据并保存为 Excel 文件</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"><span>index2.php</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ob_end_clean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">// 清除缓冲区 如果导出文件打不开加上</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$filename</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'成绩表.xlsx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Content-Type:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Content-Disposition:attachment;filename='</span><span class=\"token operator\">.</span><span class=\"token variable\">$filename</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Cache-Control:max-age=0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$writer</span> <span class=\"token operator\">=</span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>PhpOffice<span class=\"token punctuation\">\\</span>PhpSpreadsheet<span class=\"token punctuation\">\\</span>IOFactory</span><span class=\"token operator\">::</span><span class=\"token function\">createWriter</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$spreadsheet</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'Xlsx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$writer</span><span class=\"token operator\">-></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'php://output'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": [
                "Web",
                "后端",
                "PHP",
                "PHP",
                "MySQL",
                "Excel"
            ]
        },
        {
            "id": "https://www.minomie.com/hello-world/",
            "url": "https://www.minomie.com/hello-world/",
            "title": "Hello World",
            "date_published": "2024-08-20T04:02:12.696Z",
            "content_html": "<p>Welcome to <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvLw==\">Hexo</span>! This is your very first post. Check <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv\">documentation</span> for more info. If you get any problems when using Hexo, you can find the answer in <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=\">troubleshooting</span> or you can ask me on <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==\">GitHub</span>.</p>\n<h2 id=\"quick-start\"><a class=\"anchor\" href=\"#quick-start\">#</a> Quick Start</h2>\n<h3 id=\"create-a-new-post\"><a class=\"anchor\" href=\"#create-a-new-post\">#</a> Create a new post</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo new <span class=\"token string\">\"My New Post\"</span></pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s\">Writing</span></p>\n<h3 id=\"run-server\"><a class=\"anchor\" href=\"#run-server\">#</a> Run server</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo server</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=\">Server</span></p>\n<h3 id=\"generate-static-files\"><a class=\"anchor\" href=\"#generate-static-files\">#</a> Generate static files</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo generate</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s\">Generating</span></p>\n<h3 id=\"deploy-to-remote-sites\"><a class=\"anchor\" href=\"#deploy-to-remote-sites\">#</a> Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo deploy</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s\">Deployment</span></p>\n",
            "tags": []
        }
    ]
}